<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lottie 애니메이션 제어</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.7.14/lottie.min.js"></script>
    <style>
        #container {
            width: 800px;
            height: 300px;
            overflow-x: scroll;
            border: 1px solid #000;
            position: relative;
        }

        #animation-container {
            width: 2000px;
            height: 300px;
            position: absolute;
            top: 0;
        }

        #controls {
            margin-top: 10px;
        }
    </style>
</head>

<body>
    <div id="container">
        <div id="animation-container"></div>
    </div>
    <div id="controls">
        <button id="toggle-btn">시작</button>
    </div>

    <script>
        let animation;
        let isPlaying = true;
        const duration = 2000; // 애니메이션 지속 시간 (ms)
        let animationStartTime;
        const container = document.getElementById('container');
        const animContainer = document.getElementById('animation-container');
        const toggleBtn = document.getElementById('toggle-btn');

        // Lottie 애니메이션 로드
        animation = lottie.loadAnimation({
            container: animContainer,
            renderer: 'svg',
            loop: true,
            autoplay: true,
            path: 'anim.json' // Lottie 파일 경로
        });

        function updateAnimation() {
            if (!isPlaying) return;

            const currentTime = Date.now();
            const elapsedTime = currentTime - animationStartTime;
            const progress = Math.min(elapsedTime / duration, 1);

            const totalScrollWidth = animContainer.offsetWidth - container.offsetWidth;
            const scrollPosition = progress * totalScrollWidth;

            container.scrollLeft = scrollPosition;

            if (progress < 1) {
                requestAnimationFrame(updateAnimation);
            } else {
                isPlaying = false;
                toggleBtn.textContent = '시작';
            }
        }

        // 토글 버튼 이벤트 리스너
        toggleBtn.addEventListener('click', () => {
            if (isPlaying) {
                // 정지
                isPlaying = false;
                toggleBtn.textContent = '시작';
            } else {
                // 시작
                isPlaying = true;
                animationStartTime = Date.now();
                toggleBtn.textContent = '정지';
                updateAnimation();
            }
        });

        // 초기 상태 설정
        function setInitialPosition() {
            const containerWidth = container.offsetWidth;
            const animWidth = animation.animationData.w;
            const initialLeft = (containerWidth / 2) - (animWidth / 2);
            animContainer.style.left = `${initialLeft}px`;
            container.scrollLeft = 0;
        }

        // 애니메이션 로드 완료 후 초기 위치 설정
        animation.addEventListener('DOMLoaded', setInitialPosition);

        // 창 크기 변경 시 위치 재조정
        window.addEventListener('resize', setInitialPosition);
    </script>
</body>

</html>